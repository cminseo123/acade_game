<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Minesweeper</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* [1] ì˜¤ë¡œë¼ ë°°ê²½ & ê¸°ë³¸ ì„¸íŒ… */
        body { 
            font-family: Pretendard, sans-serif; 
            margin: 0; overflow: hidden;
            background: #0f0c29;
            background: linear-gradient(to bottom, #1a1a2e, #16213e, #0f0c29);
            color: white;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
        }

        .aurora-bg {
            position: absolute; inset: 0; z-index: -1;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            opacity: 0.8;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* [2] ê²Œì„ ë³´ë“œ (ìœ ë¦¬íŒ) */
        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr); /* 8x8 ê·¸ë¦¬ë“œ */
            gap: 6px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            width: 100%; max-width: 360px;
            aspect-ratio: 1/1;
        }

        /* [3] ê° ì…€ ë””ìì¸ */
        .cell {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; font-size: 1.2rem;
            transition: all 0.2s;
            position: relative;
            box-shadow: inset 0 2px 5px rgba(255,255,255,0.2), 0 2px 5px rgba(0,0,0,0.2);
        }

        .cell:active { transform: scale(0.9); }

        /* ì—´ë¦° ì…€ (ë•…ë”°ë¨¹ê¸° ì„±ê³µ) */
        .cell.revealed {
            background: rgba(0, 0, 0, 0.3);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
            transform: scale(1);
        }

        /* ê¹ƒë°œ ê½‚ìŒ */
        .cell.flagged::after {
            content: 'ğŸš©'; font-size: 1rem;
        }

        /* ì§€ë¢° í­ë°œ */
        .cell.mine {
            background: rgba(255, 0, 0, 0.6) !important;
            animation: shake 0.5s;
        }

        /* ìˆ«ì ìƒ‰ìƒ */
        .num-1 { color: #5bc0de; text-shadow: 0 0 5px #5bc0de; }
        .num-2 { color: #5cb85c; text-shadow: 0 0 5px #5cb85c; }
        .num-3 { color: #d9534f; text-shadow: 0 0 5px #d9534f; }
        .num-4 { color: #f0ad4e; text-shadow: 0 0 5px #f0ad4e; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* ìƒë‹¨ ìƒíƒœë°” */
        .status-bar {
            display: flex; justify-content: space-between; align-items: center;
            width: 100%; max-width: 360px; margin-bottom: 20px;
            padding: 0 10px;
        }
        
        .mine-count {
            background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.2); font-family: monospace; font-size: 1.2rem;
        }

        .reset-btn {
            width: 50px; height: 50px; border-radius: 50%;
            background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3);
            font-size: 1.5rem; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }
        .reset-btn:active { transform: scale(0.9); background: rgba(255,255,255,0.3); }

        /* ê²°ê³¼ ì˜¤ë²„ë ˆì´ */
        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .overlay.show { opacity: 1; pointer-events: auto; }

    </style>
</head>
<body class="flex flex-col items-center justify-center h-screen">

    <div class="aurora-bg"></div>

    <div class="absolute top-6 left-6 z-50">
        <a href="index.html" class="flex items-center justify-center w-10 h-10 rounded-full bg-white/20 backdrop-blur-md border border-white/30 text-white active:scale-90 transition">
            <i class="fa-solid fa-xmark"></i>
        </a>
    </div>

    <div class="text-center mb-6">
        <h1 class="text-3xl font-black italic text-transparent bg-clip-text bg-gradient-to-r from-cyan-300 to-blue-300">MINESWEEPER</h1>
        <p class="text-gray-400 text-xs mt-1">ì§€ë¢°ë¥¼ í”¼í•´ ë•…ì„ ë„“íˆì„¸ìš”</p>
    </div>

    <div class="status-bar">
        <div class="mine-count">ğŸ’£ <span id="mineLeft">10</span></div>
        <div class="reset-btn" onclick="initGame()">ğŸ˜</div>
        <div class="mine-count">â±ï¸ <span id="timer">000</span></div>
    </div>

    <div class="game-board" id="board"></div>

    <div class="mt-8 flex items-center gap-3 bg-white/10 px-4 py-2 rounded-full border border-white/20">
        <span class="text-xs font-bold text-gray-300">â›ï¸ í´ë¦­</span>
        <div class="relative inline-flex items-center cursor-pointer" onclick="toggleMode()">
            <input type="checkbox" id="modeSwitch" class="sr-only peer">
            <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-500"></div>
        </div>
        <span class="text-xs font-bold text-red-300">ğŸš© ê¹ƒë°œ</span>
    </div>

    <div id="resultScreen" class="overlay">
        <h2 id="resultTitle" class="text-4xl font-black mb-4 text-white">GAME OVER</h2>
        <button onclick="initGame()" class="px-8 py-3 bg-white text-black font-bold rounded-full text-lg shadow-lg active:scale-95">
            ë‹¤ì‹œ ë„ì „ â†»
        </button>
    </div>

    <script>
        const BOARD_SIZE = 8; // 8x8 (ëª¨ë°”ì¼ ìµœì í™”)
        const MINE_COUNT = 10; // ì§€ë¢° ê°œìˆ˜
        
        let board = [];
        let gameOver = false;
        let isFlagMode = false;
        let flags = 0;
        let revealedCount = 0;
        let timerInterval;
        let time = 0;

        const boardEl = document.getElementById('board');
        const mineLeftEl = document.getElementById('mineLeft');
        const timerEl = document.getElementById('timer');
        const resultScreen = document.getElementById('resultScreen');
        const resultTitle = document.getElementById('resultTitle');
        const modeSwitch = document.getElementById('modeSwitch');

        // ê²Œì„ ì‹œì‘
        initGame();

        function initGame() {
            // ì´ˆê¸°í™”
            board = [];
            gameOver = false;
            flags = 0;
            revealedCount = 0;
            time = 0;
            isFlagMode = false;
            modeSwitch.checked = false;
            
            resultScreen.classList.remove('show');
            document.querySelector('.reset-btn').innerText = 'ğŸ˜';
            mineLeftEl.innerText = MINE_COUNT;
            timerEl.innerText = '000';
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                time++;
                timerEl.innerText = time.toString().padStart(3, '0');
            }, 1000);

            createBoard();
        }

        function createBoard() {
            boardEl.innerHTML = '';
            
            // 1. ë¹ˆ ë³´ë“œ ìƒì„±
            for (let i = 0; i < BOARD_SIZE * BOARD_SIZE; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.id = i;
                cell.addEventListener('click', () => handleClick(i));
                boardEl.appendChild(cell);
                board.push({
                    isMine: false,
                    isRevealed: false,
                    isFlagged: false,
                    count: 0,
                    element: cell
                });
            }

            // 2. ì§€ë¢° ì‹¬ê¸°
            let minesPlaced = 0;
            while (minesPlaced < MINE_COUNT) {
                const idx = Math.floor(Math.random() * (BOARD_SIZE * BOARD_SIZE));
                if (!board[idx].isMine) {
                    board[idx].isMine = true;
                    minesPlaced++;
                }
            }

            // 3. ì£¼ë³€ ì§€ë¢° ê°œìˆ˜ ê³„ì‚°
            for (let i = 0; i < board.length; i++) {
                if (!board[i].isMine) {
                    const neighbors = getNeighbors(i);
                    let count = 0;
                    neighbors.forEach(idx => {
                        if (board[idx].isMine) count++;
                    });
                    board[i].count = count;
                }
            }
        }

        function toggleMode() {
            isFlagMode = !isFlagMode;
            modeSwitch.checked = isFlagMode;
        }

        function handleClick(idx) {
            if (gameOver) return;
            const cellData = board[idx];

            // [ê¹ƒë°œ ëª¨ë“œ]
            if (isFlagMode) {
                if (cellData.isRevealed) return;
                
                if (cellData.isFlagged) {
                    cellData.isFlagged = false;
                    cellData.element.classList.remove('flagged');
                    flags--;
                } else {
                    if (flags < MINE_COUNT) {
                        cellData.isFlagged = true;
                        cellData.element.classList.add('flagged');
                        flags++;
                    }
                }
                mineLeftEl.innerText = MINE_COUNT - flags;
                return;
            }

            // [ì¼ë°˜ í´ë¦­ ëª¨ë“œ]
            if (cellData.isFlagged || cellData.isRevealed) return;

            if (cellData.isMine) {
                // ğŸ’¥ í‘!
                endGame(false);
            } else {
                revealCell(idx);
                checkWin();
            }
        }

        // ì…€ ì—´ê¸° (ì¬ê·€í•¨ìˆ˜ - ë•…ë”°ë¨¹ê¸° íš¨ê³¼ í•µì‹¬)
        function revealCell(idx) {
            const cellData = board[idx];
            if (cellData.isRevealed || cellData.isFlagged) return;

            cellData.isRevealed = true;
            cellData.element.classList.add('revealed');
            revealedCount++;

            if (cellData.count > 0) {
                // ìˆ«ìê°€ ìˆìœ¼ë©´ í‘œì‹œ
                cellData.element.innerText = cellData.count;
                cellData.element.classList.add(`num-${cellData.count}`);
            } else {
                // ìˆ«ìê°€ 0ì´ë©´(ë¹ˆ ë•…ì´ë©´) ì£¼ë³€ ì‹¹ ë‹¤ ì—´ê¸° (Flood Fill)
                const neighbors = getNeighbors(idx);
                neighbors.forEach(neighborIdx => revealCell(neighborIdx));
            }
        }

        function getNeighbors(idx) {
            const neighbors = [];
            const isLeftEdge = idx % BOARD_SIZE === 0;
            const isRightEdge = idx % BOARD_SIZE === BOARD_SIZE - 1;

            if (idx >= BOARD_SIZE) { // ìƒ
                neighbors.push(idx - BOARD_SIZE);
                if (!isLeftEdge) neighbors.push(idx - BOARD_SIZE - 1); // ìƒì¢Œ
                if (!isRightEdge) neighbors.push(idx - BOARD_SIZE + 1); // ìƒìš°
            }
            if (idx < BOARD_SIZE * (BOARD_SIZE - 1)) { // í•˜
                neighbors.push(idx + BOARD_SIZE);
                if (!isLeftEdge) neighbors.push(idx + BOARD_SIZE - 1); // í•˜ì¢Œ
                if (!isRightEdge) neighbors.push(idx + BOARD_SIZE + 1); // í•˜ìš°
            }
            if (!isLeftEdge) neighbors.push(idx - 1); // ì¢Œ
            if (!isRightEdge) neighbors.push(idx + 1); // ìš°

            return neighbors;
        }

        function checkWin() {
            // ì§€ë¢° ëº€ ë‚˜ë¨¸ì§€ ë‹¤ ì—´ì—ˆìœ¼ë©´ ìŠ¹ë¦¬
            if (revealedCount === (BOARD_SIZE * BOARD_SIZE) - MINE_COUNT) {
                endGame(true);
            }
        }

        function endGame(isWin) {
            gameOver = true;
            clearInterval(timerInterval);

            if (isWin) {
                document.querySelector('.reset-btn').innerText = 'ğŸ¥³';
                resultTitle.innerText = "YOU WIN! ğŸ‰";
                resultTitle.className = "text-4xl font-black mb-4 text-green-400";
            } else {
                document.querySelector('.reset-btn').innerText = 'ğŸ˜µ';
                resultTitle.innerText = "BOOM! ğŸ’¥";
                resultTitle.className = "text-4xl font-black mb-4 text-red-500";
                
                // ëª¨ë“  ì§€ë¢° ë³´ì—¬ì£¼ê¸°
                board.forEach(cell => {
                    if (cell.isMine) {
                        cell.element.innerText = 'ğŸ’£';
                        cell.element.classList.add('mine');
                    }
                });
            }
            
            setTimeout(() => {
                resultScreen.classList.add('show');
            }, 1000);
        }
    </script>
</body>
</html>